#
# Using Conda within ENTRYPOINT was taken from:
# https://pythonspeed.com/articles/activate-conda-dockerfile/
#
# This Dockerfile uses a base image that already contains the Conda and Pip
# requirements, copies updated versions of variable subsetter source code
# (which is much quicker than creating the Python environment), and runs all
# tests.
#
FROM sds/variable-subsetter-env

ENV PYTHONDONTWRITEBYTECODE=1

WORKDIR "/home"

# Bundle app source
COPY ./tests tests
COPY ./pymods pymods
COPY subsetter.py .

ENTRYPOINT ["conda", "run", "--name", "subsetter", "/home/tests/run_tests.sh"]
